<div class="widget" *ngIf="state$ | async as state">
  <div class="widget-loading" *ngIf="state.isFetching">Loading...</div>
  <div class="widget-error" *ngIf="state.isError">Error!</div>
  <div class="no-events" *ngIf="state.isReady && state.data.length === 0; else eventsBlock">
    There are currently no events
  </div>
  <ng-template #eventsBlock>
    <div class="widget-body">
      <div class="widget-messages">
        <alg-thread-message
          class="thread-message"
          [event]="event"
          *ngFor="let event of state.data"
        ></alg-thread-message>
        <form class="footer-panel" [formGroup]="form" (ngSubmit)="sendMessage()">
          <textarea
            class="textarea"
            placeholder="Send a message..."
            pInputTextarea
            formControlName="messageToSend"
            [rows]="1"
            [autoResize]="true"
            (keydown.enter)="$event.preventDefault(); sendMessage()"
          ></textarea>
          <button
            class="send-button p-button-raised p-button-rounded alg-round-button-icon send-button-size"
            type="submit"
            icon="pi pi-send"
            pButton
            [disabled]="!form.get('messageToSend')?.value?.trim()"
          ></button>
        </form>
      </div>
    </div>
  </ng-template>
</div>
