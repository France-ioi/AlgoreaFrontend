<div class="widget">
  <ng-container *ngIf="events$ | async as events">
    <div *ngIf="widgetOpened && events.length > 0" class="widget-body">
      <div *ngFor="let event of events">
        <div>{{ event | json }}</div>
      </div>
      <div *ngIf="(threadStatus$ | async) === 'opened'">
        <textarea
          [(ngModel)]="messageToSend"
          placeholder="Send a message..."
        ></textarea>
        <p-button
          label="Submit"
          (click)="sendMessage()"
          [disabled]="!messageToSend.trim()"
          ></p-button>
      </div>
    </div>
  </ng-container>

  <div class="widget-footer">
    <p-button
      *ngIf="canOpenThread$ | async"
      label="Open thread"
      (click)="openThread()"
      [disabled]="openingThread"
    ></p-button>

    <p-button
      *ngIf="canCloseThread$ | async"
      label="Close thread"
      (click)="closeThread()"
    ></p-button>

    <p-button
      *ngIf="widgetOpened"
      label="Hide thread"
      (click)="toggleWidget(false)"
    ></p-button>

    <p-button
      *ngIf="!widgetOpened"
      [disabled]="!(threadStatus$ | async) || (threadStatus$ | async) === 'none'"
      label="Show thread"
      (click)="toggleWidget(true)"
    ></p-button>
  </div>
</div>
