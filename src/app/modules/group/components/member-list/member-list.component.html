<alg-group-composition-filter (change)="onFilterChange($event)" [defaultValue]="defaultFilter"></alg-group-composition-filter>

<p *ngIf="state === 'error';else noError" class="error-message">
  <i class="fa fa-exclamation-triangle"></i>
  Error while loading the group members
</p>

<ng-template #noError>
  <p-table #table
    [columns]="data.columns"
    [value]="data.rowData"
    [customSort]="true"
    sortMode="multiple"
    (sortFunction)="onCustomSort($event)"
    [loading]="state === 'fetching'"
  >
    <ng-template pTemplate="header" let-columns>
      <tr *ngIf="data.rowData.length > 0">
        <ng-container *ngFor="let col of data.columns">
          <th [pSortableColumn]="col.field" *ngIf="col.sortable">
            <div class="header-container">
              {{ col.header }}
              <p-sortIcon [field]="col.field"></p-sortIcon>
            </div>
          </th>
          <th *ngIf="!col.sortable">
            <div class="header-container">
              {{ col.header }}
            </div>
          </th>
        </ng-container>
      </tr>
    </ng-template>

    <ng-template
      pTemplate="body"
      let-rowData
      let-columns="columns"
    >
      <tr>
        <td *ngFor="let col of columns">
          <ng-container [ngSwitch]="col.field">
            <ng-container *ngSwitchCase="'user.login'">
              {{ rowData.user | user }}
            </ng-container>
            <ng-container *ngSwitchCase="'member_since'">
              {{ rowData.memberSince | date:'short' }}
            </ng-container>
            <ng-container *ngSwitchDefault>
              {{ rowData[col.field] }}
            </ng-container>
          </ng-container>
        </td>
      </tr>
    </ng-template>

    <ng-template pTemplate="emptymessage" let-columns>
      <tr>
        <td [attr.colspan]="columns.length">
          <p class="empty-message" i18n>This list is empty. Check below the different ways to add members or sub-groups.</p>
        </td>
      </tr>
    </ng-template>
  </p-table>
</ng-template>
