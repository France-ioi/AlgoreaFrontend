<ng-container *ngIf="activeTab$ | async as activeTab;">
  <ng-container *ngIf="currentUser$ | async as currentUser">
    <div class="tab-view-container">
      <div class="main-menu" *ngIf="!skillsDisabled || activeTab.index === 2 || !currentUser.tempUser">
        <button
          class="main-menu-button active"
          [ngClass]="{ 'active': activeTab.index === 0 }"
          (click)="onSelectionChangedByIdx(0)"
        >
          <div class="main-menu-icon-wrapper">
            <i class="ph ph-presentation main-menu-icon"></i>
          </div>
          <span class="main-menu-title" i18n="|Tab name">Content</span>
        </button>

        <button
          class="main-menu-button"
          [ngClass]="{ 'active': activeTab.index === 1 }"
          [hidden]="skillsDisabled"
          (click)="onSelectionChangedByIdx(1)"
        >
          <div class="main-menu-icon-wrapper">
            <i class="ph ph-graduation-cap main-menu-icon"></i>
          </div>
          <span class="main-menu-title" i18n="|Tab name">Skills</span>
        </button>

        <button
          class="main-menu-button"
          [ngClass]="{ 'active': activeTab.index === 2 }"
          data-cy="main-menu-group-btn"
          (click)="onSelectionChangedByIdx(2)"
          *ngIf="activeTab.index === 2 || !currentUser.tempUser"
        >
          <div class="main-menu-icon-wrapper">
            <i class="ph ph-users main-menu-icon"></i>
          </div>
          <span class="main-menu-title" i18n="|Tab name">Groups</span>
        </button>
      </div>
    </div>
  </ng-container>

  <hr class="divider">

  <ng-container *ngIf="navTreeServices[activeTab.index]!.state$ | async as state">
    <div class="spinner" *ngIf="state.isFetching">
      <alg-loading></alg-loading>
    </div>

    <alg-error
      *ngIf="state.isError"
      i18n-message message="Unable to load the list."
      icon="ph-duotone ph-warning-circle"
      [showRefreshButton]="true"
      buttonCaption="Retry"
      (refresh)="retryError(activeTab.index)"
    ></alg-error>

    <div class="watching-warning" *ngIf="state.isReady && (isWatching$ | async) && [0, 1].includes(activeTab.index)">
      <div class="content" i18n>
        This menu is filtered by the observation mode.
      </div>
    </div>

    <alg-left-nav-tree
      *ngIf="state.isReady"
      [data]="state.data"
      [elementType]="$any(['activity', 'skill', 'group'][activeTab.index])"
    ></alg-left-nav-tree>
  </ng-container>
</ng-container>
